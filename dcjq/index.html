<!DOCTYPE html>
<meta charset="utf-8">
<link href='http://fonts.googleapis.com/css?family=Open+Sans' rel='stylesheet' type='text/css'>
<script src="js/rickshaw.min.js"></script>
<script src="js/d3.v3.min.js"></script>
<style>

@import url(stack.css);
@import url(code.css);

.big {
  font-size: 128px;
}

.caption {
  font-size: 96px;
  text-align: center;
  text-shadow: 0px 2px 6px rgba(0,0,0,.5);
}

h1 {
    font-size:100px;
    line-height:140px;
    margin:0;
}

b {
    color:pink;
}

a {
    color:#FF83E2;
}

.join {
    background:#580044;
}

.shadowy {
    text-shadow: 0 0 15px #000,
        0 0 15px #000,
        0 0 15px #000,
        0 0 15px #000;
}

</style>
<body class="overview">

<section>
    <h1>a fun, difficult introduction to <b>d3</b></h1>
    <p>Tom MacWright / <a href='https://twitter.com/tmcw'>@tmcw</a> / <code><a href='http://github.com/tmcw'>tmcw</a></code>
    <br />dev @<a href='http://mapbox.com/'>MapBox</a>
    <br />writing/hackin @<a href='http://macwright.org/'>macwright.org</a></p>
</section>

<section>
  <h1><a href='http://macwright.org/presentations/dcjq/'>macwright.org/ presentations/dcjq/</a></h1>
</section>

<!--

* 5 minutes of 'stuff that's cool with d3 that should pique your interest'

* 1: primer: the difference between == and ===

* 2 minutes of how abstractions hurt and help you

* 5 minutes of stuff that d3 does that jquery did

* 1: primer: the difference between == and ===

* 10 minutes of dummy3 with == and === diff

* 5 minutes of how d3 actually does this

-->


<!-- ..................................................................... -->

<section>
<h1>(pretty things)</h1>
</section>

<section style='background:url(minute.png)'>
<p><a href='http://macwright.org/2012/02/15/minute.html'>minute</a> (keystrokes)</p>
</section>

<section style='background:url(jenks.png)'>
<p><a href='http://macwright.org/2013/02/18/literate-jenks.html'>maps</a></p>
</section>

<section style='background:url(map3d.png)'>
<p><a href='http://bl.ocks.org/dwtkns/4973620'>maps</a></p>
</section>

<!-- ..................................................................... -->

<section>
<h1>what is <b>d3?</b></h1>
</section>

<section>
<h1>what is d3 <b>not?</b></h1>
<p><strong>Not a chart library</strong> (though you can make charts with it)</p>
<p><strong>Not a map library</strong> (though you can make maps with it)</p>
</section>

<section>
<h1>what is d3 <b>not?</b></h1>
<p><strong>Not a compatibility layer</strong> (it doesn't work with bad browsers)</p>
<p><strong>Not about SVG or HTML or Canvas</strong> (though you can use it with them)</p>
</section>

<section>
<h1>what is d3 <b>not?</b></h1>
<p><strong>not an SVG abstraction layer</strong></p>
<p>it doesn't have its own way of making a line or a circle. it makes
you deal with svg elements as svg elements. plus, you can deal with HTML
elements and Canvas elements!</p>
</section>

<!-- ..................................................................... -->

<section>
<h1>d3 <b>is data&rarr;documents</b></h1>
</section>

<section>
<h1>d3 is a general purpose visualization library</h1>
</section>

<section>
<h1>d3 is a <b>general purpose</b> visualization library</h1>
</section>

<section style='background:url(gallery.png);' class='shadowy'>
<h1>d3 is a <b>general purpose</b> visualization library</h1>
</section>

<section>
<h1>what is general purpose about <b>visualizations?</b></h2>
</section>

<section>
<h1>the transformation of data into <b>information</b></h2>
</section>

<section>
<h1>the transformation of data into <b>documents</b></h2>
</section>

<section>
<h1>the transformation of data into <b>elements</b></h2>
</section>


<section style='background:url(break.gif)' class='shadowy'><h1>pretty things break</h1></section>

<section>
<a href='http://bl.ocks.org/tmcw/4945177' target='second'>challenge 1</a>,
<a href='http://bl.ocks.org/tmcw/4949593' target='second'>challenge 2</a>
</section>

<!-- ..................................................................... -->

<section>
<h1>overlap of d3 and jQuery (<b>there's a bit</b>)</h1>
</section>

<section>
<pre><code>d3.select('#foo')
  .style('background', '#000')
  .on('click', function() {})
  .append('div');

$('#foo')
  .css('background', '#000')
  .click(function() {})
  .append($('&ltdiv&gt;&lt;/div&gt;'));
</code></pre>
</section>

<section>
<pre><code>d3.json('foo.json',
  function(err, data) { });

$.getJSON('foo.json',
  function(data) { });
</code></pre>
</section>

<!-- ..................................................................... -->

<section>
<p>that's just the silly stuff, though</p>
</section>

<section>
<pre><code>// a fully-featured jquery replacement
function $(x) {
  return document.querySelectorAll(x);
}
</pre></code>
</section>

<section>
<pre><code>// a fully-featured jquery replacement
$.ajax = function(url, callback) {
  var xhr = new XMLHttpRequest();
  xhr.open("GET", url, true);
  xhr.onload = callback;
  xhr.send();
}
</pre></code>
</section>

<section style='background-image:url(oz.jpg)' />
</section>

<section>
<p>let's get to the hard stuff, then</p>
</section>

<!--  .................................................................... -->

<section class='js'>
<h1>d3 requires <b>deep proficiency in javascript</b><h1>
</section>

<section class='js'>
<h1>Javascript Primer</h1>
<ul>
    <li><a href='http://macwright.org/enable-web-developer-extensions/'>macwright.org/enable-web-developer-extensions/</a>
    <li><a href='http://eloquentjavascript.net/'>eloquentjavascript.net</a>
    <li><a href='https://developer.mozilla.org/en-US/'>developer.mozilla.org</a>
</ul>
</section>

<section class='js'>
<p>Let's review some Javascript (1x)</p>
</section>

<section class='js'>
<a target='second' href='http://macwright.org/mistakes/#5010464'>what is the difference between == and ===?</a>
</section>

<section class='js'>
<h1>questions?</h1>
<p>why did we learn that? because identifying objects is one of the biggest parts of the join</a>
</section>

<!--  .................................................................... -->

<section class='join'>
<p>now let's understand the hardest part of d3 by building it from scratch.</p>
</section>

<section class='join'>
<h1>the join</h1>
<ul>
<li>pairs an object and an element
<li>keeps track of new and old objects
<li>lets you animate differences between new &amp; old
</section>

<section class='join'>
<center>
<img src='bill.jpeg' style='height:600px' />
</center>
</section>

<section class='join'>
<a target='second' href='http://macwright.org/mistakes/#5010465'>the final dish</a>
</section>

<section class='js'>
<h1>questions?</h1>
</section>

<!--  .................................................................... -->

<section>
<p>you have the knowledge! time to d3.</p>
</section>

<section>
<pre><code>
d3.selectAll('div')
  .data([1, 2, 3])
  .enter()
  .append('div')
  .text(String);
</code></pre>
</section>

<section>
<pre><code>
// an empty selection.
// looking for instantiations of data
d3.selectAll('div')
</code></pre>
</section>

<section>
<pre><code>
// data, which would be bound to a
// selection
.data([1, 2, 3])
</code></pre>
</section>

<section>
<pre><code>
// for every time that we see data
// but we do not see an element
.enter()
</code></pre>
</section>

<section>
<pre><code>
// append an element
.append('div')
</code></pre>
</section>

<section>
<pre><code>
// and fill it with text
.text(String);
</code></pre>
</section>

<section>
<pre><code>
// and fill it with text
.text(String);
// wait what
</code></pre>
</section>

<section>
<pre><code>
// what's going on here?
.text(String);
</code></pre>
</section>

<section>
<pre><code>
d3.selectAll('div')
  .data([1, 2, 3])
  .enter()
  .append('div')
  .text(String);
</code></pre>
</section>

<section>
<pre><code>
// d3 has a few different
// functions that set stuff
.text()
.property()
.style()
.attr()
</code></pre>
</section>

<section>
<pre><code>
// each takes a function
.attr('foo', function() { })
</code></pre>
</section>

<section>
<pre><code>
// and that function gets data
// from your .data()
.attr('foo', function(d) {
  return d.foo;
})
</code></pre>
</section>

<section>
<pre><code>
// like jQuery, you can chain these
blah
  .attr('foo', 'bar')
  .attr('boo', 'burr');
</code></pre>
</section>

<section>
<pre><code>
// like jQuery, you can use them
// to get an existing value
var fooValue = blah.attr('foo');
</code></pre>
</section>

<!--  .................................................................... -->

<section>
<pre><code>
// if you provide a static argument,
// it becomes a functor
.attr('foo', 5)
</code></pre>
</section>

<section class='js'>
<h1>what's a functor? what a closure? time for <b>javascript</b></h1>
</section>

<section class='js'>
<pre><code>
// here's what a functor is
function functor(x) {
  return function() {
    return x;
  };
}
</code></pre>
</section>

<section class='js'>
<p>
we just used a closure.<br />
don't know what a closure is?<br />
<a href='http://bit.ly/js-closure-explain'>bit.ly/js-closure-explain</a>
</p>
</section>

<section>
<pre><code>
// and what it does
var val = functor(10);

// val is now a function that
// always returns 10
assert.equal(val(), 10);
</code></pre>
</section>

<section>
<p>but what did you mean by .enter()?</p>
<p>d3 is all about <strong>enter, exit, and update</strong></p>
</section>

<section>
<pre><code>// this is an empty selection
var selection = d3.selectAll('div')
  .data([1, 2, 3]);
</code></pre>
</section>

<section>
<pre><code>// for each part of the data which
// is not joined to an element in
// the selection,
// add an element
selection
  .enter()
  .append('div');
</code></pre>
</section>

<section>
<pre><code>// for each part of the selection
// that is no longer in the data,
// remove it
selection
  .exit()
  .remove();
</code></pre>
</section>

<section>
<pre><code>// for each part of the selection,
// update some attribute
selection
  .text(function(d) {
    return d.bar;
  });
</code></pre>
</section>

<section>
<p>so data is bound to the DOM</p>
<p><strong>but what does that mean?</strong></p>
</section>

<section>
<pre><code>// WE NEED TO GO DEEPER
// WHAT IS REALLY HAPPENING

&lt;div class='joined-elem'&gt;&lt;/div&gt;
// a joined element like this has
// a __data__ property where
// WE KEEP THE DATA
</code></pre>
</section>

<section>
<img src='bound_data.png' />
</section>

<section>
<p>we just awkwardly explained joins</p>
<p>read mike's explanations: <a href='http://bost.ocks.org/mike/join/'>bost.ocks.org/mike/join/</a>
<a href='http://mbostock.github.com/d3/tutorial/circle.html'>mbostock.github.com/d3/tutorial/circle.html</a></p>
</p>
</section>

<section>
<h1>Let's make three little circles!</h1>
<a target='second' href='http://tributary.io/inlet/5008943'>START IT UP</a>
</section>

<!--  .................................................................... -->

<section style='background:url(break.gif)' class='shadowy'><h1>pretty things break</h1></section>

<section>
<a href='http://geowiki.com/iD/#layer=Bing&map=20.00/38.90085/-77.02271'>iD</a>
</section>

<!--  .................................................................... -->

<section>
<h1>Why must everything be so hard!?</h1>
</section>

<section>
<ol>
  <li>Changing the DOM is <strong>mad expensive</strong></li>
</ol>
</section>

<section>
<ol>
  <li>Changing the DOM is <strong>usually the most expensive part
  of your code unless you're a horrible Javascript coder</strong></li>
</ol>
</section>

<section>
<ol>
  <li>Changing the DOM is <strong>mad expensive</strong></li>
  <li>This makes animated transitions way slicker</li>
  <li>Post-eureka moment, it makes code way more compact</li>
  <li>Data updates, like real-time data or history viewers, become obvious rather than awful</li>
</ol>
</section>

<!--  .................................................................... -->

<section>
<p>Joining data to elements is the trickiest part of d3. Here are some
less-tricky transformations</p>
</section>

<section>
<h1><a target='second' href='http://macwright.org/mistakes/#5010467'>The Scale</a></h1>
<pre><code>
d3.scale.linear()
    // data comes in
    .domain([0, 100])
    // representation comes out
    .range([0, 1]);
</pre></code>
</section>

<section>
<h1><a target='second' href='http://macwright.org/mistakes/#5010471'>Geo Stuff</a></h1>
<pre><code>
var projection = d3.geo.mercator();
// data goes in
// representation comes out
var px projection([lon, lat]);
</pre></code>
</section>

<!-- ..................................................................... -->

<section style='background:url(joy.jpg);'>
<h1>Let's make Unknown Pleasures!</h1>
<a target='second' href='http://tributary.io/inlet/5009040'>START IT UP</a>
</section>

<!-- ..................................................................... -->

<section style='background:url(break.gif)' class='shadowy'><h1>pretty things break</h1></section>

<section style='background:url(voronoi.png)'>
<p><a href='http://www.christophermanning.org/projects/voronoi-diagram-with-force-directed-nodes-and-delaunay-links/'>force directed voronoi</a></p>
</section>

<section style='background:url(chord.png)'>
<p><a href='http://bost.ocks.org/mike/uberdata/'>chord diagram</a></p>
</section>

<!-- ..................................................................... -->

<section>
<h1>how to write 'good' d3</h1>
</section>

<section>
<h1>Reuse your selections</h1>
<p>Same rule as jQuery's reusing <code>$blah = $('#blah')</code></p>
<code><pre>var fooSelection = d3.selectAll('#foo');
// do not turn around and do
d3.selectAll('#foo')
// again
</pre></code>
</section>

<section>
<h1>Write reusable components (if any)</h1>
<a href='http://bost.ocks.org/mike/chart/'>http://bost.ocks.org/mike/chart/</a>
</section>

<!-- ..................................................................... -->

<section>
<h1>back to d3</h1>
</section>

<section style='background-image:url(wolf.jpg);background-sizing:100%;' class='shadowy'>
<h1>d3 is <b>filled with algorithms</b></h1>
</section>

<section>
<h1>voronoi, quadtrees, convex hull, projections, circle fitting</h1>
</section>

<section>
<h1><b>why?</b></h1>
</section>

<section>
<h1>data &rarr; representation requires <b>thinking</b></h1>
</section>

<section style='background:url(circlepack.png);'>
<h1><a href='http://bl.ocks.org/mbostock/4063530'>(for visualization)</a></h1>
</section>

<section>
<h1>d3 also has <b>old school visualization whizzes</b></h1>
<p>and they love math</p>
</section>

<!-- ..................................................................... -->

<section>
<h1>want an abstraction?</h1>
<ul>
    <li><a href='http://nvd3.org/'>NVD3</a>
    <li><a href='http://tenxer.github.com/xcharts/'>xCharts</a>
    <li><a href='http://polychart.com/'>polychart</a>
</ul>
</section>

<section>
<code><pre>var graph = new Rickshaw.Graph({
element: document.querySelector("#rick"),
renderer: 'bar',
series:[{
  data:[{ x:0, y:40 }, { x:1, y:49 }],
  color:'steelblue'
}, {
  data:[{ x:0, y:20 }, { x:1, y:24 }],
  color:'lightblue'
}]});
</pre></code>
</section>

<!-- ..................................................................... -->

<section>
<p><strong>4: Postscript, Where to Go From Here</strong>
</section>

<section>
<p><strong>Buy <a href='http://www.amazon.com/Grammar-Graphics-Statistics-Computing/dp/0387245448'>The Grammar of Graphics</a></strong></p>
<p>It is not about d3.</p>
<p>d3 is about it.</p>
</section>

<section>
<p><strong>See <a href='http://bl.ocks.org/mbostock'>Mike's bits of code</a></strong></p>
<p>It's zany.</p>
</section>

<section>
<h1>Tools for writing d3</h1>
<ul>
  <li><a href='http://macwright.org/enable-web-developer-extensions/'>web developer extension</a></li>
  <li><a href='https://github.com/mbostock/d3/wiki'>the documentation</a></li>
  <li><a href='http://livecoding.io/'>livecoding.io</a> and <a href='http://tributary.io/'>tributary.io</a> and
  <a href='http://bl.ocks.org/'>bl.ocks.org</a></li>
  <li>determination clear eyes don't fail</li>
</ul>
</section>

<section>
<h1>People who write about this</h1>
<ul>
  <li><a href='http://www.jasondavies.com/'>jasondavies.com</a>,
  <li><a href='http://mbostock.github.com/'>mbostock.github.com</a>,
  <li><a href='http://alignedleft.com/tutorials/'>alignedleft.com/tutorials</a>
  <li><a href='http://macwright.org'>macwright.org (me)</a>,
</ul>
</section>

<section>
<h1>Thank you!</h1>
(ask me about MapBox and/or your inability to have a digital copy of DC's code of law)
</section>

<script src="stack.v0.js"></script>
<script src="highlight.v0.js"></script>
